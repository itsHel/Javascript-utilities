<title>TryIt Editor</title>
<link rel=icon href="https://cdn.discordapp.com/emojis/474325997181730826.png?v=1">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">

<link href="_buttons.css" rel="stylesheet">

<style>
    body{
        line-height: 1.6;
        color: #4f4f4f;
        font-family: "Roboto",sans-serif;

        margin:60px auto;
        max-width:1100px;
        font-size:22px;
        background:rgba(0,0,0,0.05);
        font-family: 'Comic Sans MS', 'Comic Sans' !important;
    }
    button{
        font-family: inherit;
        font-size: inherit;
        line-height: inherit;
    }
    #drop-wrapper, body > div{
        font-family: unset;
        padding:2rem;
        border-radius:0.5rem;
        border: 1px solid #d3d8db;
        box-shadow: 0 1px 1px rgba(0,0,0,.05);
        background:white;
        margin-bottom:18px;
    }
    #drop-wrapper{
        height:250px;
        position:relative;
    }
    .highlight{
        border:2px dashed red !important;
    }
    #movable{
        height:100px;
        width:100px;
        background: orange;
        position:absolute;
    }
    label{
        font-size: 16px;
        min-width: 0;
    }
    #inputs{
        display: flex;
        justify-content: space-between;
    }
    #inputs > *{
        margin-right:6px;
    }
    .material-icons-outlined{
        font-size:32px;
    }
</style>

<script>
    (function scrollHold(){
        return;
        "use strict";
        const delay = 500;
        const triggerMove = window.innerHeight;
        const triggerTimeThreshold = 500;
        // const triggerMove = 100;

        let oldPos = window.scrollY, newPos;
        let triggered = false;
        let triggeredAt = 0;
        let oldTime = 0;
        let delta = 0;
        let Timeout;
        let holdX = 0, holdY = 0;
        let highestDiff = 0;
        

        // Plus debounce ?
        // Nesmi brzdit po tom co se pdf stranka nacetla?
        // only large pdf
        // ignore On home/end buttons + when directly paging?
        //* Dont hold if scrolling is slow!          /s ?
        // Hold scrollTo triggeruje myscroll        - check if e.timeStamp is too close to the last one?

        window.addEventListener("scroll", detectScroll, {passive: true, once: true});

        function detectScroll(e){
            newPos = window.scrollY;
            console.error("WINDOW Y: " + window.scrollY);
            let now = Date.now();
            
            if(!triggered){
                triggered = true;
                oldTime = now;
                triggeredAt = now;
                window.addEventListener("scroll", detectScroll, {passive: true, once: true});
                Timeout = setTimeout(function(){
                    detectScroll();
                }, delay + 50);
                return;
            }

            if(oldTime > now - delay){
                // Keep counting
                let newDiff = newPos - oldPos;
                
                console.log("NEWPOS  " + newPos);
                console.log("OLDPOS  " + oldPos);
                console.log("-------------------------");
                console.log("POS difference: " + newDiff);
                console.log("-------------------------");
                console.log("DELTA BEFORE " + delta);
                // ONLY WORKS DOWNSCROLL
                if(Math.abs(highestDiff) > Math.abs(newDiff)){
                    console.log("highestDiff YES: " + highestDiff);
                    delta += (highestDiff);
                }

                oldTime = now;
                console.log("DELTA AFTER " + delta);
                
                highestDiff = newDiff;
                
                if(Math.abs(delta) > triggerMove){
                    // Surpress scroll
                    if(holdX || holdY){
                        console.log("BEFORE:" + window.scrollY);
                        window.scrollTo(holdX, holdY);
                        console.log("AFTER: " + window.scrollY);
                        // READD ONCE?
                    } else {
                        if(triggeredAt > now - triggerTimeThreshold){
                            holdX = window.scrollX;
                            holdY = window.scrollY;
                        } else {
                            console.warn("ELSEeeeeeeee");
                            resetScroll();
                        }
                    }
                }

                window.addEventListener("scroll", detectScroll, {passive: true, once: true});
                clearTimeout(Timeout);
                Timeout = setTimeout(function(){
                    detectScroll();
                }, delay + 100);
            } else {
                resetScroll();
            }

            if(!(Math.abs(delta) > triggerMove))
                oldPos = newPos;
            else
                oldPos = holdY;
        }

        function resetScroll(){
            console.log("delta---------------------------------------------- " + delta);
            delta = 0;
            holdX = 0;
            holdY = 0;
            clearTimeout(Timeout);
            triggered = false;
            window.addEventListener("scroll", detectScroll, {passive: true, once: true});   
        }
    })();
</script>

<script>
    window.addEventListener("load", function(){
        document.querySelectorAll(".ripple-button, .ripple-hollow-button").forEach(button => {
            addRipple(button);
        });
    });

    function addRipple(button){
        button.addEventListener("click", function(e){
            let x, y;
            if((e.originalEvent || e).isTrusted){
                x = e.offsetX;
                y = e.offsetY;
            } else {
                x = e.target.clientWidth / 2;
                y = e.target.clientHeight / 2;
            }

            let html = "<span class='ripple' style='left:" + x + "px;top:" + y + "px;'></span>";

            button.insertAdjacentHTML("beforeend", html);
        
            setTimeout(function(){
                button.querySelector(".ripple").remove();
            }, 1000);
        });
    }

</script>

<body>
    <!-- *************************************************** Db *************************************************** -->
    <div style="display:flex; justify-content: space-around;">
        <button id=db-add class="button-gradient bg-lightblue ripple-button">Test</button>
        <div id=db-result>_</div>
        <button id=db-add-time class="button-gradient bg-yellow ripple-button">Add</button>
        <div id=db-time-result>_</div>
        <button id=db-show-time class="button-gradient bg-red ripple-button">Show</button>
    </div>

    <script>
        // *************************************************** Google notes ***************************************************
        // TODO - Get and save data from idb or Localstorage
        const style = "position:absolute; left:115%; top:0; padding-left:3px; color:#4d5156; max-width:250px; white-space: nowrap; text-overflow:ellipsis; border-left:3px solid #42464a;";
        let links = document.querySelectorAll(".yuRUbf");
        
        // fsf search
        let data = {
            "www.root.cz": "THIS IS ROOT",
            "twitter.com": "TWITTER -----",
            "something": "somethhhhhh"
        };
        
        // Add icons
        const svgStyle = 'style="width:9px;height:9px;margin-bottom:1px;"';
        const svgPac = '<svg id=mysvg viewBox="0 0 541.6 571.11" ' + svgStyle + '><path style="fill:#70757a" d="M535.441,412.339A280.868,280.868 0 1,1 536.186,161.733L284.493,286.29Z"/></svg>';
        
        document.querySelectorAll(".eFM0qc > span").forEach(linkNav => {
            let div = "<div class='link-add-note' style='display: inline-block; visibility:visible; margin-right:6px;'>" + svgPac + "</div>";

            linkNav.insertAdjacentHTML('afterend', div);
            linkNav.parentNode.querySelector(".link-add-note").addEventListener("click", addNote);

            function addNote(){
                // TODO - localstorage or idb ?
            }
        });

        // Add data
        links.forEach(link => {
            let href = link.querySelector("a").href;
            let match = href.match(/\/\/(.+?)(\/|$)/);
            if(!match)
                return;
            
            let url = match[1];

            if(!data.hasOwnProperty(url))
                return;

            link.style.position = "relative";

            let text = data[url];
            let div = "<div title='" + text + "' style='" + style + "'>" + text + "</div>";

            link.insertAdjacentHTML('beforeend', div);
        });

        // *************************************************** indexedDB ***************************************************
        // https://javascript.info/indexeddb
        // indexedDB.deleteDatabase("store");
        // Gets deleted by cookie deletion
        try {
            let openRequest = indexedDB.open("store", 8);

            openRequest.onupgradeneeded = function() {
                console.log("onUpdageEnded");

                let db = openRequest.result;

                if(!db.objectStoreNames.contains('books')){                                     // if there's no "books" store
                    db.createObjectStore('books', {keyPath: 'id', autoIncrement: true});        // create it
                }

                let books = this.transaction.objectStore("books");
                let index = books.createIndex('price_idx', 'price');
            }

            openRequest.onerror = function() {
                console.warn("onError", openRequest.error);
            };

            openRequest.onsuccess = function() {
                console.log("onSuccess");
                let db = openRequest.result;

                // db.createObjectStore("books", {keyPath: "id", autoIncrement: true});
            };

            openRequest.onblocked = function() {
                console.log("onBlocked");
                // this event shouldn't trigger if we handle onversionchange correctly

                // it means that there's another open connection to the same database
                // and it wasn't closed after db.onversionchange triggered for it
            };

            document.querySelector("#db-add").addEventListener("click", function(){
                let db = openRequest.result;

                let transaction = db.transaction("books", "readwrite");
                let books = transaction.objectStore("books");

                let book = {price: 11, created: new Date()};
                let book2 = {price: 11, created: new Date()};

                let request = books.add(book);
                let request2 = books.add(book2);

                let priceIndex = books.index("price_idx");
                // let request3 = books.get(2);
                let request3 = books.getAll(IDBKeyRange.only(2));
                let request4 = priceIndex.getAll(IDBKeyRange.upperBound(20));
                // console.log(mybook);

                request.onsuccess = function() { 
                    console.log("onSuccess Book added to the store", this.result);
                };
                request.onerror = function() {
                    console.log("onError", this.error);
                };

                request2.onsuccess = function() { 
                    console.log("onSuccess Book added to the store", this.result);
                };
                request2.onerror = function() {
                    console.log("onError", this.error);
                };

                request3.onsuccess = function() { 
                    console.log("search 3 result:");
                    console.log(this.result);
                };
                request3.onerror = function() {
                    console.log("search 3 error: ", this.error);
                };

                request4.onsuccess = function() { 
                    console.log("search 4 result:");
                    console.log(this.result);
                };
                request4.onerror = function() {
                    console.log("search 4 error: ", this.error);
                };

                // Short syntax
                db.transaction("books").objectStore("books").get(4).onsuccess = function(event) {
                    console.log(event);
                    console.log(this.result);
                    console.log("Id 4 result price:  " + event.target.result.price);

                    let data = this.result;
                    data.price += 100;

                    let objectStore = db.transaction("books", "readwrite").objectStore("books");
                    let requestUpdate = objectStore.put(data);
                };
            });

            document.querySelector("#db-show-time").addEventListener("click", function(){
                let db = openRequest.result;
                let colors = db.transaction("colors", "readwrite").objectStore("colors");

                colors.getAll().onsuccess = function(){
                    console.warn("getAll:");
                    console.log(this.result);
                }
            });

            async function setCount(type){
                let db = _openRequest.result;
                let transaction = db.transaction("colors", "readwrite");
                let colors = transaction.objectStore("colors");

                let typeIndex = colors.index("type");

                typeIndex.getAll(IDBKeyRange.only(type)).onsuccess = function(){
                    console.log(this.result.length);
                    
                    let target = document.querySelector("#target");
                    target.textContent = this.result.length;
                };
            }

            function getCount(type){
                let db = _openRequest.result;
                let transaction = db.transaction("colors", "readwrite");
                let colors = transaction.objectStore("colors");

                let typeIndex = colors.index("type");
                
                return new Promise(resolve => {
                    typeIndex.getAll(IDBKeyRange.only(type)).onsuccess = function(){
                        resolve(this.result.length);
                        console.log("success");
                    };
                })
            }


            // *************************************************** Inks ***************************************************
            
            // replace - inkss, inks, types
            
            let mydata = {
                darkred: ['2021-12-02 08:46:40', '2021-12-02 08:49:40', '2021-12-02 09:40:40', '2021-12-02 09:48:40'],
                lightblue: ['2021-12-03 08:06:40', '2021-12-03 08:46:40']
            };

            var realData = {};
            var _openRequest = indexedDB.open("types", 2);

            function init(){
                _openRequest.onupgradeneeded = function() {
                    let db = this.result;

                    if (!db.objectStoreNames.contains("inkss")) {
                        db.createObjectStore("inkss", {keyPath: 'id', autoIncrement: true});
                    
                        this.transaction.objectStore("inkss").createIndex('type', 'type');
                        this.transaction.objectStore("inkss").createIndex('created', 'created');
                    }
                }

                _openRequest.onerror = function() {
                    console.warn("onError", this.error);
                };

                _openRequest.onsuccess = function() {
                    console.log("INIT");

                    let db = this.result;
                    let inkss = db.transaction("inkss", "readwrite").objectStore("inkss");

                if(!false)
                    for(const property in mydata){
                        let type = property;
                        let dates = mydata[property];

                        for(let i = 0; i < dates.length; i++){
                            let inks = {type: type, created: dates[i]};

                            inkss.add(inks);
                        }
                        
                        // inkss.add(col).onsuccess = function() { 
                        //     console.log("onSuccess col added to the store", this.result);
                        // };
                    }

                    inkss.getAll().onsuccess = function(){
                        // console.warn("getAll:");
                        // console.log(this.result);

                        let data = this.result;

                        let uniqueCounts = {};
                        data.forEach(record => {
                            if(uniqueCounts.hasOwnProperty(record.type)){
                                ++uniqueCounts[record.type];
                            } else {
                                uniqueCounts[record.type] = 1;
                                realData[record.type] = [];
                            }

                            realData[record.type].push(record.created);
                        });

                        // console.log(uniqueCounts);
                        // console.log(realData);

                        // Do stuff on init
                    }
                };
            }

            function addD(type){
                let now = new Date().toLocaleString("sv").slice(0,3);

                let db = _openRequest.result;
                let inkss = db.transaction("inkss", "readwrite").objectStore("inkss");

                let col = {type: type, created: now};
                inkss.add(col);

                if(!realData.hasOwnProperty(type)){
                    realData[type] = [];
                }

                realData[type].push(now);
            }

            document.querySelector("#db-add-time").addEventListener("click", function(){
                addD(this.textContent);
            });

            init();
        } catch(e){}
        // https://gist.github.com/inexorabletash/704e9688f99ac12dd336         - Data selection
    </script>

    <!-- *************************************************** Buttons *************************************************** -->
    <div style="display:flex; justify-content:space-between;position: relative;">
        <button class="button-gradient bg-lightblue ripple-button">Lightblue</button>
        <button class="button-gradient bg-red ripple-button">Red</button>
        <button class="button-gradient bg-green ripple-button">Green</button>
        <button class="button-gradient bg-blue ripple-button">Blue</button>
        <button class="button-gradient bg-yellow ripple-button">Yellow</button>
        <button class="button-gradient bg-black ripple-button">Black</button>
    </div>
    <div style="display:flex; justify-content:space-between;position: relative;">
        <button class="icon-button ib-red"><span class=icon-text>Ib Red</span><span class="material-icons-outlined icon-icon">shuffle</span></button>
        <button class="icon-button ib-yellow"><span class=icon-text>Ib Yellow</span><span class="material-icons-outlined icon-icon">shuffle</span></button>
        <button class="icon-button ib-blue sm"><span class=icon-text>Ib Blue sm</span><span class="material-icons-outlined icon-icon">shuffle</span></button>
        <button class="icon-button ib-lightblue"><span class=icon-text>Ib Lblue</span><span class="material-icons-outlined icon-icon">shuffle</span></button>
        <button class="icon-button ib-black"><span class=icon-text>Ib Black</span><span class="material-icons-outlined icon-icon">shuffle</span></button>
        <button class="button ripple-button">Ripple</button>
        <button class="button ripple-hollow-button">Hollow</button>
    </div>
    <div style="display:flex; justify-content:space-between;position: relative;">
        <button class="button ripple-button b-orange">Button</button>
        <button class="button ripple-button b-red">Button</button>
        <button class="button ripple-button b-red include-icon-button">Button</button>
        <button class="button ripple-button b-purple">Button</button>
        <button class="button ripple-button b-gray">Button</button>
    </div>

    <!-- *************************************************** Yesterday *************************************************** -->
    <script>
        let but = $(".include-icon-button");
        but.on("click", function(e){
            if(e.offsetX > but[0].offsetWidth){
                // :after click
                let yesterday = new Date(Date.now() - 86_400_000); 
                console.log(yesterday);
            } else {
                // button click

            }
        });
    </script>

    <style>
        .include-icon-button{
            position: relative;
            overflow: visible;
        }
        .include-icon-button:after{
            content: "";
            position: absolute;
            height: 48px;
            width:48px;
            left:110%;
            top:0;
            border:1px solid rgba(0,0,0,0.15);
            border-radius: 50%;

            background-position: center;
            background-repeat: no-repeat;
            background-image: url("data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' height='32px' viewBox='0 0 24 24' width='32px' fill='rgb(33,33,33)'><path d='M0 0h24v24H0V0z' fill='none'/><path d='M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.25 2.52.77-1.28-3.52-2.09V8z'/></svg>");
        }
    </style>

    <!-- *************************************************** Inputs *************************************************** -->
    <div id=inputs>
        <label class="input-placeholder">
            <input placeholder="Placeholder">
            <span>Placeholder</span>
        </label>

        <label class="input-placeholder input-placeholder-color">
            <input placeholder="Placeholder">
            <span>Placeholder</span>
        </label>

        <label class="input-placeholder input-placeholder-noborder">
            <input placeholder="Placeholder">
            <span>Placeholder</span>
        </label>
    </div>

    <style>
        :root{
            --input-font-size: 18px;
            --input-focus-color: crimson;
        }
        .input-placeholder{
            position:relative;
            border:2px solid black;
            border-radius:4px;
            display: inline-block;
            transition: all 0.25s;
        }
        .input-placeholder span{
            position: absolute;
            font-size: var(--input-font-size);
            top:0;
            left:0;
            margin: calc(var(--input-font-size) / 2.5) calc(var(--input-font-size) / 2.5 - 2px);
            padding:0 2px;
            transition: all 0.25s;
            pointer-events: none;
        }
        .input-placeholder input{
            all:unset;
            cursor:text;
            padding: calc(var(--input-font-size) / 2.5);
            font-size: var(--input-font-size);
            display: block;
            transition: all 0.25s;
        }
        .input-placeholder input::placeholder{
            opacity:0;
        }
        .input-placeholder:focus-within span, .input-placeholder input:not(:placeholder-shown) + span{
            font-size: calc(var(--input-font-size) - 2px);
            top:-55%;
            background:white;
        }
    
        .input-placeholder-color:focus-within{
            border:2px solid var(--input-focus-color);
        }
        .input-placeholder-color:focus-within span{
            color: var(--input-focus-color);
        }
    
        .input-placeholder-noborder{
            border-radius:0;
            border:none;
            border-bottom: 2px solid black;
        }
        .input-placeholder-noborder input, .input-placeholder-noborder span{
            margin-left:0;
            padding-left:0;
        }
        .input-placeholder-noborder:focus-within span, .input-placeholder-noborder input:not(:placeholder-shown) + span{
            opacity:0.5;
        }
    </style>

    <!-- *************************************************** Checkboxes *************************************************** -->
    <div>
        <label class=custom-checkbox-label>
            <input id=showtime class=custom-checkbox type="checkbox">
            <span class=custom-checkbox-wrapper>
                <span class=background></span>
                <svg></svg>
            </span>
            Zobrazit cas
        </label>

        <label class=custom-checkbox-label>
            <input id=showtime class=custom-checkbox type="checkbox">
            <span class=custom-checkbox-wrapper>
                <span class=background></span>
                <svg></svg>
            </span>
            Zobrazit cas
        </label>

        <label class=custom-checkbox-label>
            <input id=showtime class=custom-checkbox type="checkbox">
            <span class="custom-checkbox-wrapper checkbox-green">
                <span class=background></span>
                <svg></svg>
            </span>
            Zobrazit cas
        </label>

        <label class=custom-checkbox-label>
            <input id=showtime class=custom-checkbox type="checkbox">
            <span class="custom-checkbox-wrapper checkbox-green">
                <span class=background></span>
                <svg></svg>
            </span>
            Zobrazit cas
        </label>
    </div>

    <!-- *************************************************** Radio-line + Arrow hover *************************************************** -->
    <div>
        <div id=radios>
            <label>
                <input class=radio type=radio name=myradio>
                <span>First</span>
            </label>
            <label>
                <input class=radio type=radio name=myradio>
                <span>Second</span>
            </label>
            <label>
                <input class=radio type=radio name=myradio>
                <span>Third</span>
            </label>
            <div class=radio-line></div>
        </div>

        <div id=link-hover-arrow>
            <a href=#>
                First link
                <span class=ico>
                    <svg viewBox="0 0 24 24" fill="#000000"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/></svg>
                </span>
            </a>
            <a href=#>
                Second link
                <span class=ico>
                    <svg viewBox="0 0 24 24" fill="#000000"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"/></svg>
                </span>
            </a>
        </div>
    </div>

    <style>
        :root{
            --line-color: crimson;
        }
        .radio{
            padding:4px;
            position: relative;
            display: inline-block;
            text-align: center;
            display: none;
        }
        .radio input:checked + span:after{
            transition-delay: 0s;
            left:0;
            width:100%;
        }
        #radios{
            position: relative;
            display: inline-block;
        }
        #radios label{
            cursor:pointer;
            padding:5px;
            margin:10px;
        }
        .radio-line{
            position: absolute;
            width:100%;
            height:2px;
            background: var(--line-color);
            left:0;
            top:115%;
            width:0;
        }

        #link-hover-arrow{
            display: inline-flex;
        }
        #link-hover-arrow a{
            transition: 0.3s;
            color: #000;
            text-decoration: none;
        }
        #link-hover-arrow a:hover{
            color: crimson;
        }
        #link-hover-arrow a:hover svg{
            opacity: 1;
            fill:crimson;
            transform: translateX(0px);
            transition: color 0.3s, opacity 0.6s, transform 0.35s;
        }
        #link-hover-arrow a svg{
            opacity: 0;
            vertical-align: middle;
            width: 22px;
            transform: translateX(-20px);
            transition: color 0.3s, opacity 0.25s, transform 0.35s;
        }
    </style>

    <script>
        myRadio(document.querySelector("#radios"));

        function myRadio(wrapper, shiftTime = 250){
            let timeout;
            let line = wrapper.querySelector(".radio-line");
            line.style.transition = shiftTime + "ms";

            // Must be mousedown to get :checked element before its changed
            wrapper.addEventListener("mousedown", function(e){
                let clickedEl = e.target.closest("label");

                if(clickedEl){
                    let thisWidth = clickedEl.offsetWidth;
                    let thisLeft = clickedEl.offsetLeft;
                    
                    if(line.style.width == "0" || line.style.width == ""){
                        // First click
                        line.style.left = thisLeft;
                        line.style.width = thisWidth + "px";
                    } else {
                        let lastIndex = Array.from(wrapper.children).indexOf(wrapper.querySelector(":checked").parentNode);
                        let newIndex = Array.from(wrapper.children).indexOf(clickedEl);

                        if(newIndex == lastIndex)
                            return;

                        clearTimeout(timeout);
                        
                        if(newIndex > lastIndex){
                            // Left to right

                            let fullWidth = clickedEl.offsetLeft - line.offsetLeft + clickedEl.offsetWidth;
                            
                            line.style.left = line.offsetLeft + "px";
                            line.style.right = "auto";
                            line.style.width = fullWidth + "px";

                            timeout = setTimeout(function(){
                                line.style.width = clickedEl.offsetWidth + "px";
                                line.style.left = clickedEl.offsetLeft + "px"
                            }, shiftTime);
                        } else {
                            // Right to left

                            let lineOffsetRight = line.offsetLeft + line.offsetWidth
                            let rightPos = clickedEl.parentNode.offsetWidth - lineOffsetRight;
                            let fullWidth = lineOffsetRight - clickedEl.offsetLeft;

                            line.style.right = (rightPos) + "px";
                            line.style.left = "auto";
                            line.style.width = fullWidth + "px";

                            timeout = setTimeout(function(){
                                line.style.width = clickedEl.offsetWidth + "px";
                                line.style.right = (clickedEl.parentNode.offsetWidth - (clickedEl.offsetLeft + clickedEl.offsetWidth)) + "px"
                            }, shiftTime);
                        }
                    }
                }
            });
        }
    </script>

    <!-- *************************************************** Fill button *************************************************** -->
    <div>
        <div class=fill-button>text</div>
    </div>

    <style>
        /* .fill-button{
            position: relative;
            padding:0.75rem 1rem;
            text-align:center;
            background:black;
            overflow:hidden;
            border: 1px solid #d3d8db; 
            box-shadow: 0 1px 1px rgba(0,0,0,.05); 
            cursor:pointer;
        }
        .fill-button span{
            background:white;
            transition: width 0.7s, padding-top 0.7s;
            width: 0;
            padding-top:0;
            position: absolute;
            border-radius:100%;
            transform: translate(-50%, -50%);
            z-index: 0;
        }
        .fill-button text{
            color:white;
            position: relative;
            z-index: 1;
            transition: color 0.7s;
        }
        .fill-button:hover span{
            width:calc(105% * 2);
            padding-top:calc(105% * 2);
        }
        .fill-button:hover text{
            color:black;
        } */
    </style>
    <script>
        // _fillButtons(document.querySelectorAll(".fill-button"));

        // function _fillButtons(buttons){
        //     buttons.forEach(button => {
        //         let fill = button.querySelector("span");

        //         button.addEventListener("mouseover", function(e){
        //             fill.style.left = e.pageX - button.offsetLeft + "px";
        //             fill.style.top = e.pageY - button.offsetTop + "px";
        //         });
        //         button.addEventListener("mouseout", function(e){
        //             fill.style.left = e.pageX - button.offsetLeft + "px";
        //             fill.style.top = e.pageY - button.offsetTop + "px";
        //         });
        //     });
        // }

        fillButtons(document.querySelectorAll(".fill-button"));

        function fillButtons(buttons){
            buttons.forEach(button => {
                button.innerHTML = "<span></span><text>" + button.textContent + "</text>";
                let fill = button.querySelector("span");

                button.addEventListener("mouseover", function(e){
                    fill.style.left = e.pageX - button.offsetLeft + "px";
                    fill.style.top = e.pageY - button.offsetTop + "px";
                });
                button.addEventListener("mouseout", function(e){
                    fill.style.left = e.pageX - button.offsetLeft + "px";
                    fill.style.top = e.pageY - button.offsetTop + "px";
                });
            });

            const style = `<style>.fill-button{ position: relative; padding:0.75rem 1rem; text-align:center; background:black; overflow:hidden; border: 1px solid #d3d8db; box-shadow: 0 1px 1px rgba(0,0,0,.05); cursor:pointer;} 
                            .fill-button span{ background:white; transition: width 0.7s, padding-top 0.7s; width: 0; padding-top:0; position: absolute; border-radius:100%; transform: translate(-50%, -50%); z-index: 0; } 
                            .fill-button text{ color:white; position: relative; z-index: 1; transition: color 0.7s; } .fill-button:hover span{ width:calc(105% * 2); padding-top:calc(105% * 2); } .fill-button:hover text{ color:black; }</style>`;

            document.querySelector("html").insertAdjacentHTML("beforeend", style);
        }
    </script>

    <!-- *************************************************** Strike shift *************************************************** -->
    <div>
        <div class="strike-container" style="margin-bottom:0;">
            <ul style="list-style-type:none;padding:0;margin:0;display:inline;">
                <li><span>Home</span></li>
                <li><span>About us</span></li>
                <li><span>Contact</span></li>
            </ul>
            <svg id=mysvg viewBox="0 0 541.6 571.11"> <path style="fill:black" d="M535.441,412.339A280.868,280.868 0 1,1 536.186,161.733L284.493,286.29Z"/> </svg>
        </div>

        <style>
            #mysvg{
                width:20px;
                height:20px;
            }

            .strike-container li{
                display:inline-block;
            }
            .strike-container span {
                padding: 0 20px;
                position: relative;
                display: inline-block;
                cursor: pointer;
            }
            .strike-container span:before {
                content: '';
                position: absolute;
                width: 0%;
                height: 2px;
                top: 50%;
                margin-top: -0.5px;
                background: #000;
                transition: width 0.35s cubic-bezier(0.22, 0.61, 0.36, 1);
                right: -5px;
            }
            .strike-container span:hover:before {
                left: -5px;
                width: calc(100% + 10px);
                transition: width 0.35s cubic-bezier(0.22, 0.61, 0.36, 1);
            }
        </style>
    </div>

    <!-- *************************************************** Tooltips *************************************************** -->
    <div id=tooltip-wrapper>
        <div id=tooltip class=tooltips>Tooltip something</div>
        <div id=tooltip1 class=tooltips>Tooltip 1 something</div>
        <div id=tooltip2 class=tooltips>Tooltip 2 something</div>
    </div>

    <style>
        .tooltips{
            transform: scale(0.7);
            opacity:0;
            transition: transform 325ms, opacity 325ms; 
            transition-timing-function: cubic-bezier(.54,1.5,.38,1.11);
            text-align: center;
            border:1px solid rgba(0,0,0,0.15);
            padding:8px;
            border-radius: 10px;
        }
        .tooltips:hover{
            opacity:1;
            transform: scale(1) translateY(-10px);
        }
        #tooltip1{
            transition-timing-function: cubic-bezier(0.375, 0.785, 0.32, 1.175);
        }
        #tooltip2{
            transition-timing-function: cubic-bezier(.38,.33,.37,1.67);
        }
    </style>

    <!-- *************************************************** icons *************************************************** -->
    <!-- <style>

    </style>

    <div>
        <ul id=glowing>
            <li>
                <i class="material-icons-outlined">mood</i>
            </li>
            <li>
                <i class="material-icons-outlined">hot_tub</i>
            </li>
            <li>
                <i class="material-icons-outlined">bathtub</i>
            </li>
        </ul>
    </div> -->

    <!-- *************************************************** Animated svg *************************************************** -->
    
    <!-- pathLength=1 must be set, otherwise base stroke-dashoffset & stroke-dasharray on path.getTotalLength(); -->
    <style>
        #svg{
            width:50px;
            color:crimson;
            cursor:pointer;
        }
        #svg path{
            transition: all 0.8s;
            stroke-dashoffset: 0;
            stroke-dasharray: 1;
        }
    </style>

    <div style="display: flex; justify-content:space-around;">
        <svg id=svg viewBox="0 2 24 24" aria-hidden="true" focusable="false"><path pathLength=1 fill="none" stroke="currentColor" stroke-width="3" d="M1.73 12.91l6.37 6.37L22.79 4.59"/></svg>
        
        <div class="trapdoor" style="position:relative;">
            <div class="top door"></div>
            <div class="bottom door"></div>
            <div class="door-inside">Hi</div>
        </div>
    </div>

    <script>
        document.querySelector("#svg").addEventListener("click", function(){
            let path = this.querySelector("path");

            path.style.strokeDashoffset = Number(!Number(path.style.strokeDashoffset));
        });
    </script>
    
    <!-- *************************************************** Trapdoor *************************************************** -->
    <style>
        :root{
            --door-font-size: 30px;
        }
        .trapdoor {
            transform: translateZ(0px);
            -webkit-font-smoothing: antialiased;
            width: 200px;
            height: 50px;
            box-shadow: inset -7px 0px 12px -8px rgba(0, 0, 0, 0.3), inset 7px 0px 12px -8px rgba(0, 0, 0, 0.3);
            background: rgba(0, 0, 0, 0.25);
            transition: background 400ms ease-in-out;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .door-inside{
            font-size: var(--door-font-size);
        }
        .trapdoor:hover {
            background: #fff;
        }
        .trapdoor:hover .door {
            box-shadow: 0px 0px 10px -2px rgba(0, 0, 0, 0.4);
            transform: scale(1.08);
        }
        .trapdoor:hover .top {
            top: -50%;
        }
        .trapdoor:hover .bottom {
            top: 100%;
        }
        .top {
            top: 0%;
            left: 0px;
        }
        .top:before {
            top: -5px;
            top: calc(-1 * var(--door-font-size) + 27px);
        }
        .bottom {
            top: 50%;
            left: 0px;
        }
        .bottom:before {
            top: -30px;
            top: calc(-1 * var(--door-font-size) + 2px);
        }
        .door {
            transition: top 400ms, box-shadow 200ms, transform 300ms;
            transition-timing-function: ease-in-out;
            background-color: #fff;
            position: absolute;
            overflow: hidden;
            width: 100%;
            z-index: 2;
            height: 50%;
        }
        .door:before {
            position: absolute;
            font-size: var(--door-font-size);
            display: block;
            color: #3e5875;
            content: "Door";
            width: 100%;
            height: 20px;
            text-align:center;
        }
    </style>

    <!-- *************************************************** Info clip-path, Counter *************************************************** -->
    <div style="display:flex; justify-content:space-between;">
        <div id=info>
            <span class=ico>i</span>
            <div class=text>
                Some info text<br>...and more
            </div>
        </div>

        <div style="display:flex; justify-content:center; align-items:center; flex:1;">
            <div class="counter">
                <span class="arrow arrow-top"><svg viewBox="0 0 24 24"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14l-6-6z"/></svg></span>
                <span class=count>1</span>
                <span class="arrow arrow-bottom"><svg viewBox="0 0 24 24"><path d="M24 24H0V0h24v24z" fill="none" opacity=".87"/><path d="M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6-1.41-1.41z"/></svg></span>
            </div>
        </div>
    </div>

    <style>
        #info{
            padding:2.5rem 2rem;
            clip-path: circle(5% at 96% 14%);
            transition: all ease-in-out .3s;
            max-width: 500px;
            background: black;
            position: relative;
            border-radius:20px;
            flex:1;
        }
        #info .ico{
            color:white;
            position:absolute;
            top:0px;
            right:1.2rem;
            font-weight: bold;
            font-size:1.5rem;
            transition: all ease-in-out .3s;
        }
        #info .text{
            color:white;
            background: transparent;
        }
        #info:hover, #info:focus{
            clip-path: circle(75%);
            outline:none;
        }
        #info:hover .ico, #info:focus .ico{
            opacity:0;
        }

        .counter{
            position: relative;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border:2px solid crimson;
            user-select: none;
            font-weight: bold;
            vertical-align:center;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size:14px;
            cursor: pointer;
            transition: background 0.2s;
            background: rgba(0,0,0,0.0);
        }
        .counter:hover{
            background: rgba(220, 20, 60, 0.075);
        }
        .counter:focus{
            box-shadow: 0 0 6px 2px rgb(0 0 0 / 75%);
            background: rgba(0,0,0,0.1);
            outline:none;
        }
        .counter .arrow{
            position: absolute;
            line-height: 1px;
            width:48px;
            height: 0px;
            text-align: center;
            opacity: 0;
            z-index:1;
            transition: 0.25s;
        }
        .counter svg{
            width:24px;
            fill: rgba(0,0,0,0.4);
            transition: 0.2s;
        }
        .counter .arrow-top{
            bottom: calc(70% + 24px);
        }
        .counter .arrow-bottom{
            top:calc(70% + 1px);
        }
        .counter:hover .arrow{
            height: 24px;
            opacity: 1;
        }
        .counter:hover .arrow-top{
            bottom:100%;
        }
        .counter:hover .arrow-bottom{
            top:calc(100% + 1px);
        }
        .counter .arrow:hover svg{
            fill: rgba(0,0,0,0.8);
        }
    </style>
    <!-- *************************************************** Multi select - jQuery *************************************************** -->
    <div>
        <div id=link-XX>
            <ul id=link-XX-items-wrapper>
                <li class=link-XX-item-input><input id=link-XX-input autocomplete=off spellcheck=false placeholder="Something"></li>
            </ul>
            <div id=XX-autocomplete-items></div>
        </div>
    </div>

    <script>
        // Validate mails split by , OR ;
        function validateMails(mail){
            let mails = mail.split(/;|,/);

            let atLeastOne = false;
            for(let i = 0; i < mails.length; i++){
                if(mails[i] && !mails[i].match(/.+@.+/)){
                    return false;
                } else {
                    if(mails[i]){
                        atLeastOne = true;
                    }
                }
            }

            if(atLeastOne){
                return true;
            } else {
                return false;
            }
        }

        jQuery.fn.extend({
            myFadeIn: function(time = 400){
                this.css({
                    transition: "opacity " + time + "ms ease-in, transform " + time/2 + "ms ease-out", 
                    overflow: "visible",
                    height: "auto",
                    padding: "",
                    margin: "",
                    // transition: "opacity " + time + "ms", 
                    pointerEvents: "all",
                    transform: "",
                    opacity:1
                });
                return this;
            },
            myFadeOut: function(time = 400){
                this.css({
                    transition: "opacity " + time + "ms ease-in, transform " + time/2 + "ms ease-out", 
                    overflow: "hidden",
                    height: 0,
                    padding:0,
                    margin:0,
                    // transition: "opacity " + time + "ms",
                    pointerEvents: "none",
                    transform: "scale(0.9)",
                    opacity:0
                });
                return this;
            }
        });

        myAutocomplete(true);
        function myAutocomplete(first = false){
            let $searchInput = $("#link-XX-input");
            let $wrapper = $("#XX-autocomplete-items");

            // $.ajax({
            //     method: "POST",
            //     url: "ajax/get-mails_ajax.php",
            //     success: function(data){
            //         let result = JSON.parse(data);

            //         if(result.total == 0)
            //             return;
                    
            //         result = result.data;

            //         // Reset
            //         $(".autocomplete-item").remove();
            //         $(".link-XX-item").remove();
            //         $searchInput.val("");
            //         $wrapper.myFadeOut(0);

            //         result = result.sort((a, b) => b.times_used - a.times_used);

            //         // Create dropdown
            //         for(let i = 0; i < result.length; i++){
            //             addAutocompleteItem(result[i].email, $wrapper);
            //         }
            //     },
            //     error: function(request, status, error){}
            // });

            $(".autocomplete-item").remove();
            $(".link-XX-item").remove();
            $searchInput.val("");
            $wrapper.myFadeOut(0);

            // *************************************************** Test ***************************************************
            let result = [{email:"SOMETHING"}, {email:"SOMEMAIL"}, {email:"SOMEOTHERMAIL"}, {email:"nomail"}];
            // Create dropdown
            for(let i = 0; i < result.length; i++){
                addAutocompleteItem(result[i].email, $wrapper);
            }

            if(first){
                $(window).on("click", function(e){
                    if(!e.target.closest("#link-XX") && e.target.className != "link-XX-item"){
                        $wrapper.myFadeOut(0);
                    }
                });

                $searchInput.on("focus", function(){
                    $wrapper.myFadeIn();
                });

                // Alter dropdown
                $searchInput.on("keyup focus", function(e){
                    if(e.key?.toLowerCase() == "enter")
                        return;

                    let search = $(this).val().trim();
                    let show = false;
                    
                    $(".autocomplete-item").each(function(){
                        let origText = $(this).data("text");

                        if(origText.toLowerCase().match(search.toLowerCase())){
                            let pos = origText.toLowerCase().indexOf(search.toLowerCase());

                            let newText = origText.slice(0, pos) + "<b>" + search + "</b>" + origText.slice(pos + search.length);

                            $(this).html(newText);
                            $(this).css({display: "block"});
                            show = true;
                        } else {
                            $(this).css({display: "none"});
                            $(this).html(origText);
                        }
                    });

                    if(!show){
                        $wrapper.myFadeOut(0);
                    } else {
                        if($wrapper.css("opacity") == 0)
                            $wrapper.myFadeIn();
                    }
                });

                // Create new mail box
                $searchInput.on("keyup", function(e){
                    if(e.key.toLowerCase() == "enter"){
                        let mail = $(this).val().trim();

                        if(mail){
                            let mails = mail.split(/;|,/);
                            mails.forEach(newMail => {
                                $(".autocomplete-item").each(function(){
                                    if($(this).text() == newMail){
                                        $(this).addClass("item-checked");
                                    }
                                });

                                createMyBox(newMail, true);               // Box created on enter
                            });
                        }
                    }
                });

                $("#link-XX-items-wrapper").on("click", function(e){
                    if(e.target.classList != "link-XX-item")
                        $searchInput.focus();
                });
            }
        }

        function addAutocompleteItem(mail, $wrapper, checked = false){
            let row = "<div class='autocomplete-item " + ((checked) ? "item-checked" : "") + "' data-text='" + mail + "' tabindex=-1>" + mail + "</div>";        // Tabindex to make it focusable

            $wrapper.append(row);

            $(".autocomplete-item:last-of-type").on("click", function(){
                let text = $(this).text();

                if(!$(this).hasClass("item-checked")){
                    createMyBox(text);                                    // Box created on item click
                    $(this).addClass("item-checked");
                } else {
                    $(this).removeClass("item-checked");
                    
                    $(".link-XX-item").each(function(){
                        if($(this).text() == text){
                            $(this).remove();
                        }
                    });
                }
            });
        }

        // After server responded
        function addAutocompleteItemsAfterConfirm(){
            let $wrapper = $("#XX-autocomplete-items");

            let inputMail = $("#link-XX-input").val().trim();
            if(inputMail){
                createMyBox(inputMail, true);                             // Box created on mail send
            }

            $(".link-XX-item.newest").each(function(){
                addAutocompleteItem($(this).text(), $wrapper, true);
            });
        }

        function myAutocompleteReset(){
            $(".link-XX-item").remove();
            $("#link-XX-input").val("");
            $(".item-checked").removeClass("item-checked");
        }

        function createMyBox(text, newest = false){
            let div = "<li class='link-XX-item " + ((newest) ? "newest" : "") + "'>" + text + "</li>";
            $(".link-XX-item-input").before(div);
            $("#link-XX-input").val("");
            let $addedDiv = $(".link-XX-item");
            $addedDiv = $addedDiv.eq($addedDiv.length - 1);

            $addedDiv.on("click", function(){
                let text = $(this).text();

                $(".autocomplete-item").each(function(){
                    if(text == $(this).data("text")){
                        $(this).removeClass("item-checked");
                    }
                });

                $(this).remove();
            });
        }
    </script>

    <style>
        #link-XX-input::-webkit-search-cancel-button {
            font-size: 1.2rem !important;
            transform: translateY(-1px);
            margin-right: 5px;
            cursor: pointer;
        }

        #create-link-options {
            padding: 0.75rem 0 0.5rem 0;
        }

        #user-select + div:before {
            content: "Uivatel";
        }

        #link-XX-input, #modal-XX {
            font-size: 1rem;
            padding-left: 7px;
            box-shadow: 2px 2px 4px 0 rgba(0, 0, 0, 0.15);
            border: 1px solid #b1b1b1;
            height: 40px;
            box-sizing: border-box;
            width: 100%;
        }
        #link-XX-input::placeholder, #modal-XX::placeholder {
            color: rgba(0, 0, 0, 0.4);
        }
        #link-XX-input:focus, #modal-XX:focus {
            outline: 1px solid black;
            border-radius: 4px;
        }

        #user-list {
            padding: 1rem 0;
        }

        .link-blank {
            cursor: alias;
        }

        #link-XX {
            font-size: 1rem;
            box-sizing: border-box;
            width: 100%;
            box-sizing: border-box;
            position: relative;
            border: 1px solid #c7d6db;
        }
        #link-XX:before {
            content: "Poslat na:";
            position: absolute;
            top: -25px;
            color: #888888;
            font-weight: 600;
        }
        #link-XX:focus-within {
            border-color: #2dccba;
            box-shadow: 0 0 2px 1px rgba(45, 204, 186, 0.5);
        }

        #link-XX-items-wrapper {
            min-height: 46px;
            gap: 6px;
            list-style-type: none;
            padding: 7px 10px;
            margin: 0;
            display: flex;
            align-items: center;
            flex-wrap: wrap;
            cursor: text;
            box-sizing: border-box;
            background-color: #f5f8f9;
        }

        .link-XX-item, .link-XX-item-input {
            cursor: pointer;
            height: 100%;
            display: inline-block;
            padding: 5px;
            box-sizing: border-box;
            outline: 1px solid #2dccba;
            background-color: #e2fffc;
        }

        .link-XX-item:hover:after {
            color: #212529;
        }

        .link-XX-item:after {
            content: "\00d7";
            font-weight: bold;
            transition: 0.1s;
            padding-left: 6px;
            padding-right: 1px;
            line-height: 1;
            color: rgba(0, 0, 0, 0.3);
            font-size: 1.5rem;
            vertical-align: text-top;
        }

        .link-XX-item-input {
            padding: 0;
            flex-grow: 1;
            cursor: text;
            position: relative;
            outline: 0 !important;
            background-color: #f5f8f9;
        }

        #link-XX-input {
            all: unset;
            padding: 5px;
            border-radius: 0 !important;
            line-height: 26px;
            width: 100%;
            box-sizing: border-box;
        }
        #link-XX-input:focus {
            outline: 0 !important;
        }

        #XX-picked-items {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            box-sizing: border-box;
        }
        #XX-picked-items div {
            box-sizing: border-box;
            display: inline-block;
            cursor: pointer;
            border-radius: 5px;
            height: 28px;
            margin: 6px 5px 6px 0;
            padding: 4px 6px;
            color: white;
            background-color: #212529;
        }
        #XX-picked-items div:first-of-type {
            margin-left: 7px;
        }

        #XX-autocomplete-items {
            box-sizing: border-box;
            position: absolute;
            border: 1px solid #212529;
            border-top: none;
            z-index: 999;
            width: 100%;
            top: calc(100% + 1px);
            box-shadow: 0px 6px 16px 0px rgba(0, 0, 0, 0.2);
            max-height: 300px;
            overflow: auto !important;
            scrollbar-width: thin;
        }

        .autocomplete-item {
            box-sizing: border-box;
            width: 100%;
            padding: 7px;
            padding-left: 8px;
            cursor: pointer;
            background-color: #f6f6f6;
            border-bottom: 1px solid #d4d4d4;
            transition: background-color 0.1s;
        }
        .autocomplete-item:hover {
            background-color: #e9e9e9;
        }
        .autocomplete-item:before {
            content: "";
            display: inline-block;
            width: 18px;
            vertical-align: sub;
            margin-right: 5px;
            height: 18px;
            transition: 0.3s;
            border: 1px solid rgba(0, 0, 0, 0.4);
        }

        .autocomplete-item.item-checked {
            background: #e2fffc !important;
            border-bottom: 1px solid #2dccba !important;
        }
        .autocomplete-item.item-checked:before {
            background-color: #2dccba;
            background-image: url('data:image/svg+xml;charset=utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 -2 28 28" aria-hidden="true" focusable="false"><path fill="none" stroke="rgb(255, 255, 255)" stroke-width="3" d="M1.73 12.91l6.37 6.37L22.79 4.59"/></svg>');
        }
    </style>

    <!-- *************************************************** Hover outside buttons *************************************************** -->
    <div id=hover-close>
        <div class=added-text>
            <div class=text>Some texttttttt<br>...and more</div>
            <div class=close-wrapper>
                <span class=ico>X</span>
            </div>
        </div>
    </div>

    <style>
        .added-text{
            position: relative;
            border: 2px solid black;
            box-shadow: 2px 2px 6px 2px rgba(0, 0, 0, 0.23);
            transition: box-shadow 0.2s;
            display: inline-block;
            transform-origin: top left;
            /* backface-visibility: hidden;
            -webkit-backface-visibility: hidden; */
            -webkit-transform: translateZ(0) scale(1.0, 1.0);
            transform: translateZ(0);
        }
        .added-text .text{
            outline:none;
            position: relative;
            background-color:rgba(255,255,255,0.85);
            padding:1rem 1rem;
            white-space: pre-line;
            z-index:1000;
        }
        .added-text:focus-within{
            box-shadow: 0 0 12px #000000;
        }
        .added-text .ico{
            position: absolute;
            top:25%;
            right:25%;
            border-radius: 50%;
            border:none;
            cursor: pointer;
            transition: all 0.25s;
            color:black;
            opacity:0;
        }
        .added-text:hover .close-wrapper, .added-text:focus-within .close-wrapper{
            width: 10rem;
            height: 10rem;
        }
        .added-text:hover .ico, .added-text:focus-within .ico{
            opacity: 1;
        }
        .close-wrapper{
            border:1px solid red;
            position: absolute;
            width:0;
            height:0;
            top:0;
            right:0;
            z-index:999;
            transition: 0.25s cubic-bezier(0.25, 0, 0, 1);
            transform: translate(50%, -50%) translateZ(0);
            /* backface-visibility: hidden;
            -webkit-backface-visibility: hidden; */
        }
    </style>

    <!-- *************************************************** Movable cube + canvas *************************************************** -->
    <div id=drop-wrapper>
        <div id=movable draggable=true></div>
    </div>

    <div id=canvas-wrapper>
        <canvas id=canvas style="border:2px dashed DeepSkyBlue"></canvas>
     </div>
 
     <div>
         <img id=reflect-canvas>
     </div>
    
    <script>        
        // Text
        $("#loading").on("click", function(e){
            if(e.target.classList.contains("editable"))
                return;
            let x = e.offsetX;
            let y = e.offsetY;
            console.log(y);
            $("<div class='editable b' contenteditable=true></div>").appendTo("#loading").css({backgroundColor:"rgba(255,255,255,0.666)", minWidth:"75px", padding:"0.5rem 1rem", width:"px",height:"px",border: "1px solid orange", position:"absolute", top:y+"px", left:x+"px"}).focus();
        });

        // Canvas
        const canvas = document.querySelector("canvas");
        
        canvas.width = $(canvas.parentNode).width() - 4;        // - border
        canvas.height = 240;
        let coord = { x: 0, y: 0 };
        let outOfCanvas = false;
        var ctx = canvas.getContext("2d");

        $(window).on("mousedown", start);
        $(window).on("mouseup", stop);

        function start(e){
            $(window).on("mousemove", draw);
            coord.x = e.offsetX;
            coord.y = e.offsetY;
        }
        function stop(e){
            $(window).off("mousemove");
        }

        function draw(e){
            if(e.target.nodeName.toLowerCase() != "canvas"){
                // $(window).off("mousemove");
                outOfCanvas = true;
                coord.x = e.offsetX;
                coord.y = e.offsetY;
                return;
            }

            if(outOfCanvas){
                // Target was out and now is back to canvas
                outOfCanvas = false;
                coord.x = e.offsetX;
                coord.y = e.offsetY;
            }

            ctx.beginPath();
            ctx.lineWidth = 5;
            ctx.lineCap = "round";
            ctx.strokeStyle = "red";
            ctx.moveTo(coord.x, coord.y);
            ctx.lineTo(e.offsetX, e.offsetY);
            ctx.stroke();
            coord.x = e.offsetX;
            coord.y = e.offsetY;
            
            $("#reflect-canvas").attr("src", document.querySelector("canvas").toDataURL());
        }
    </script>

    <script>
        var differenceX, differenceY;        // Position of mouseX/Y in object

        $("#drop-wrapper").each(function(index){
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(function(event){
                $(this).on(event, preventDefaults);
            });

            ['dragenter', 'dragover'].forEach(eventName => {
                $(this).on(eventName, () => {$(this).addClass("highlight");});
            });
 
            ['dragleave', 'drop'].forEach(eventName => {
                $(this).on(eventName, () => {$(this).removeClass("highlight")});
            });

            $(this).on("drop", function(e){
                let dropX, dropY;

                if(e.target.id == "movable"){
                    // Dropping object in itself has different offsetX/Y
                    dropX = e.target.offsetLeft + e.offsetX;
                    dropY = e.target.offsetTop + e.offsetY;
                } else {
                    dropX = e.offsetX;
                    dropY = e.offsetY;
                }

                let newX = dropX - differenceX;
                let newY = dropY - differenceY;
                $("#movable").css({top: newY, left: newX});
            });
        });
        
        $("#movable").on("dragstart", function(e){
            differenceX = e.offsetX;
            differenceY = e.offsetY;
            e.target.style.filter = "grayscale(0.8)";
        });
        
        $("#movable").on("dragend", function(e){
            e.target.style.filter = "grayscale(0)";
        });

        function preventDefaults(e){
            e.preventDefault();
            e.stopPropagation();
        }
    </script>

    <script>
        $(function(){
            // Modal
            // Show only once per session ?
            if(true || sessionStorage["modalshown"])
                return;

            // Css
            $("body").append(`<style>#z-modal-full{ top:0; left:0; position: fixed; height:100%; width:100%; display:flex; justify-content: center; align-items: center; background:rgba(0,0,0,0.5); cursor:pointer; } #z-wrapper{ padding:20px; background:white; cursor:default; height:auto; box-shadow: 0px 0px 30px 0px rgb(2 2 2); border-radius:5px; } #z-wrapper { max-width:80%; } #z-wrapper img{ width:100%; } @media (max-width: 850px) { #z-wrapper { max-width:95%; } }</style>`);
            
            // Modal html
            $("<div id=z-modal-full><div id=z-wrapper><img src='https://image.freepik.com/free-photo/galaxy-system-millions-billions-stars-together-with-gas-dust_39386-369.jpg'></div></div>").hide().appendTo("body").fadeIn();
            
            $("#z-modal-full").on("click", function(e){
                if(e.target.id == "z-modal-full"){
                    $("#z-modal-full").fadeOut();
                    sessionStorage["modalshown"] = 1;
                }
            });
            $(window).on("keydown", function(e){
                if(e.key == "Escape"){
                    $("#z-modal-full").fadeOut();
                    sessionStorage["modalshown"] = 1;
                }
            });
        });
    </script>

    <style>
        #z-modal-full{
            top:0;
            left:0;
            position: fixed;
            height:100%;
            width:100%;
            display:flex;
            justify-content: center;
            align-items: center;
            background:rgba(0,0,0,0.5);
            cursor:pointer;
        }
        #z-wrapper{
            padding:20px;
            background:white;
            cursor:default;
            height:auto;
            box-shadow: 0px 0px 30px 0px rgb(2 2 2);
            border-radius:5px;
        }
        #z-wrapper {
            max-width:80%;
        }

        #z-wrapper img{
            width:100%;
        }
        #canvas{
            cursor:crosshair;
            width:100%;
        }
        @media (max-width: 850px) {
            #z-wrapper {
                max-width:95%;
            } 
        }
    </style>

    <!-- *************************************************** IntersectionObserver *************************************************** -->
    <div id=test1>
        <div id=target></div>
    </div>

    <script>
        (function setGotop(){
            if(!('IntersectionObserver' in window))
                return;
                
            let target = document.querySelector("#target");

            let options = {root: null, rootMargin: "-100px", threshold: 0};

            let observer = new IntersectionObserver(function(entries){
                if(entries[0].isIntersecting){
                    console.log(entries[0]);
                    target.style.backgroundColor = "orange";                
                } else {
                    console.log(entries[0]);
                    target.style.backgroundColor = "crimson";                
                }
            }, options);

            observer.observe(target);
        })();
    </script>

    <style>
        #test1{
            display: flex;
            height:400px;
            color:red;
        }
        #target{
            height:200px;
            width:200px;
            background-color: crimson;
            transition: 0.5s;
        }
    </style>

    <!-- *************************************************** Paging idk, idc *************************************************** -->
    <script>
        this.createPaging = function(){
            let pagingId = tableEl.id + "-paging";
            let wrapper = document.querySelector("#" + pagingId);
            
            if(!self.perPage){
                if(wrapper){
                    wrapper.innerHTML = "";
                }
                return;
            }

            let pagesCount = Math.ceil(totalResults/self.perPage);
            
            if(pagesCount == 0 || pagesCount == 1){
                if(wrapper){
                    wrapper.innerHTML = "";
                }
                return;
            }

            if(!wrapper){
                let wrapperHtml = "<div id='" + pagingId + "' class=paging-wrapper></div>";

                tableEl.insertAdjacentHTML('beforebegin', wrapperHtml);
            } else {
                wrapper.innerHTML = "";
            }

            let html = "<div class='paging prev " + ((self.pagePos == 1) ? "icon-disabled" : "paging-enabled") + "'><span class='material-icons'>arrow_back_ios_new</span></div>";
            
            let dotsInserted = false;
            for(let i = 1; i < pagesCount + 1; i++){
                // Always render all if 5 or less pages
                if(pagesCount > 5){
                    // Always render first and last
                    if(i != 1 && i != pagesCount){
                        // Always render before pos, pos and after pos
                        if(i + 1 != self.pagePos && i != self.pagePos && i - 1 != self.pagePos){
                            // If first or last pos render at least 2 siblings
                            if(!((self.pagePos == 1 && i - 2 == self.pagePos) || (self.pagePos == pagesCount && i + 2 == self.pagePos))){   
                                if(!dotsInserted){
                                    dotsInserted = true;
                                    html += "<div class='paging-page paging paging-dots'>...</div>"; 
                                }

                                continue;
                            }
                        }
                    }
                }

                let active = (self.pagePos == i) ? "page-active" : "paging-enabled";
                html += "<div class='paging-page paging " + active + "' data-index=" + i + ">" + i + "</div>"; 
                dotsInserted = false;
            }

            html += "<div class='paging next " + ((self.pagePos == pagesCount) ? "icon-disabled" : "paging-enabled") + "'><span class='material-icons'>arrow_forward_ios</span></div>";

            // GoTo
            html += "<label class=paging-goto><input type=number class=myinput placeholder='" + self.pagePos + "' value='" + self.pagePos + "'></label>";

            // Total
            let shownFrom = (self.pagePos - 1) * self.perPage;
            let shownTo = (shownFrom + self.perPage > totalResults) ? totalResults : (shownFrom + self.perPage);
            html += "<div class=paging-info><span class=mobile-hide>Zobrazeno </span><b>" + (shownFrom + 1) + "</b> - <b>" + shownTo + "</b> ze <b>" + totalResults + "</b></div>";

            document.querySelector("#" + pagingId).insertAdjacentHTML('afterbegin', html);

            document.querySelector("#" + pagingId + " .paging-goto input").addEventListener("keydown", function(e){
                if(e.key.toLowerCase() == "enter"){
                    let gotoPage = this.value;
                    if(gotoPage < 1 || gotoPage == self.pagePos || gotoPage > pagesCount)
                        return;

                        self.pagePos = gotoPage;

                    let loadfunction = parentDiv.dataset.loadFunction;
                    loadTableFunctions[loadfunction]();
                }
            });

            document.querySelectorAll("#" + pagingId + " .paging-enabled").forEach(function(el){
                el.addEventListener("click", function(){
                    if(this.classList.contains("prev")){
                        --self.pagePos;
                    } else if(this.classList.contains("next")){
                        ++self.pagePos;
                    } else {
                        self.pagePos = this.dataset.index;
                    }
                    
                    let loadfunction = parentDiv.dataset.loadFunction;
                    loadTableFunctions[loadfunction]();
                });
            });
        }
    </script>

    <style>
        .paging-wrapper {
            display: flex;
            margin: 2rem 0 2rem 0;
            flex-wrap: wrap;
        }
        .paging-wrapper:empty {
            margin: 0;
        }
        .paging-wrapper .next, .paging-wrapper .prev {
            height: 18px;
            padding: 6px 4px;
            margin: 2px 2px;
            color: rgba(0, 0, 0, 0.54);
        }
        .paging-wrapper .next span, .paging-wrapper .prev span {
            font-size: 18px;
        }
        .paging {
            transition: 0.2s;
            cursor: pointer;
            padding: 6px 10px;
            border-radius: 4px;
            margin: 0 1px;
            align-self: flex-start;
        }
        .paging:hover {
            background-color: #2dccba;
            color: white;
        }
        .page-active {
            cursor: default;
            background-color: #2dccba;
            color: white;
        }
        .paging-dots {
            cursor: default;
            margin: 0;
            padding: 6px 9px !important;
            background-color: revert !important;
            color: revert !important;
        }
        .paging-info {
            margin-left: auto;
            font-style: italic;
            padding: 6px 0;
            white-space: nowrap;
        }
        .paging-goto {
            color: #888888;
            margin-left: 2rem;
        }
        .paging-goto input {
            margin-left: 0.5rem;
            padding: 0;
            text-align: right;
            width: 50px;
            border-radius: 4px;
            height: 34px;
            padding-right: 1px;
        }
    </style>
